import{_ as ee,r as i,c as te,o as ae,j as y,h as a,i as n,w as l,f as s,u as le,g as u,l as oe,v as ne,p as f,x as se,F as D,y as x,e as R,t as d,z as ie,A as de}from"./index-CNVEcACA.js";import{_ as F}from"./request-CwFpdHqZ.js";import{u as ue}from"./index.es-AM15teyr.js";const re={key:0,class:"loading-container"},ce={key:1,class:"registration-container"},me={class:"top-right"},_e={class:"filter-section"},pe={class:"filter-section"},fe={class:"card-content"},ve={class:"doctor-info"},ge={class:"doctor-detail"},ye={class:"registration-section"},be={class:"time-tags"},he={__name:"Registration",setup(ke){const z={resident:"住院医师",attending:"主治医师",associate_chief:"副主任医师",chief:"主任医师"},S=i(""),k=i(null),V=i(null),T=i([]),C=i(!1),r=i({}),v=i({doctor_id:"",patient_id:"",date:"",timeSlot:""}),M=i("info"),B=i(!0),K=i([{id:1,name:"中山大学附属第一医院"},{id:2,name:"中山大学孙逸仙纪念医院"},{id:3,name:"北京协和医院"}]),N=i([{id:1,name:"心血管内科"},{id:2,name:"神经外科"},{id:3,name:"消化内科"},{id:4,name:"呼吸内科"},{id:5,name:"骨科"},{id:6,name:"儿科"},{id:7,name:"妇产科"},{id:8,name:"眼科"},{id:9,name:"耳鼻喉科"},{id:10,name:"皮肤科"},{id:11,name:"内分泌科"},{id:12,name:"肾内科"},{id:13,name:"血液科"},{id:14,name:"风湿免疫科"},{id:15,name:"急诊科"}]),{runAsync:j}=ue(()=>F.get("/api/patient/doctorlist"),{manual:!0}),b=()=>{j().then(o=>{o.data?T.value=o.data.data:T.value=[]})},H=te(()=>T.value.filter(o=>{const e=o.name.toLowerCase().includes(S.value.toLowerCase()),m=!k.value||o.hospital_id===k.value,_=!V.value||o.department_id===V.value;return e&&m&&_})),I=o=>{r.value=o,C.value=!0,M.value="info",$(o.schedule)},U=i([]),$=o=>{var w,g;const e=de(),m=[],_=["monday","tuesday","wednesday","thursday","friday"];for(let c=0;c<_.length;c++){const p=_[c],h=e.add(c,"day").format("YYYY-MM-DD");(w=o[p])!=null&&w.morning&&m.push({date:h,time:"上午",selected:!1}),(g=o[p])!=null&&g.afternoon&&m.push({date:h,time:"下午",selected:!1})}U.value=m},q=o=>{U.value.forEach(e=>e.selected=!1),o.selected=!0,v.value.date=o.date,v.value.timeSlot=o.time,v.value.doctor_id=r.value.id,v.value.patient_id=ie.value},O=()=>{F.post("/api/patient/registration",v.value).then(o=>{C.value=!1}).catch(o=>{var e;ElMessage.error(((e=o.data)==null?void 0:e.msg)||"挂号失败，请稍后再试")})},Q=le(),W=()=>{Q.push("/registration-records")};return ae(()=>{b(),B.value=!1}),(o,e)=>{const m=s("el-icon"),_=s("el-button"),w=s("el-input"),g=s("el-col"),c=s("el-row"),p=s("el-radio"),h=s("el-radio-group"),L=s("el-avatar"),G=s("el-card"),Y=s("el-tab-pane"),J=s("el-tag"),A=s("el-form-item"),P=s("el-form"),X=s("el-tabs"),Z=s("el-dialog");return B.value?(u(),y("div",re,[a(m,{class:"loading-icon",size:40},{default:l(()=>[a(oe(ne))]),_:1}),e[5]||(e[5]=n("p",null,"正在加载...",-1))])):(u(),y("div",ce,[n("div",me,[a(_,{type:"primary",onClick:W},{default:l(()=>e[6]||(e[6]=[f("查看挂号记录")])),_:1,__:[6]})]),a(c,{gutter:20,class:"search-bar"},{default:l(()=>[a(g,{span:16},{default:l(()=>[a(w,{modelValue:S.value,"onUpdate:modelValue":e[0]||(e[0]=t=>S.value=t),placeholder:"请输入医生姓名",clearable:"",onClear:b,onKeyup:se(b,["enter"])},null,8,["modelValue"])]),_:1})]),_:1}),a(c,{class:"filter-tags"},{default:l(()=>[a(g,{span:24},{default:l(()=>[n("div",_e,[e[8]||(e[8]=n("h4",null,"医院：",-1)),a(h,{modelValue:k.value,"onUpdate:modelValue":e[1]||(e[1]=t=>k.value=t),onChange:b},{default:l(()=>[a(p,{label:null,border:""},{default:l(()=>e[7]||(e[7]=[f("全部")])),_:1,__:[7]}),(u(!0),y(D,null,x(K.value,t=>(u(),R(p,{key:t.id,label:t.id,border:""},{default:l(()=>[f(d(t.name),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),n("div",pe,[e[10]||(e[10]=n("h4",null,"科室：",-1)),a(h,{modelValue:V.value,"onUpdate:modelValue":e[2]||(e[2]=t=>V.value=t),onChange:b},{default:l(()=>[a(p,{label:null,border:""},{default:l(()=>e[9]||(e[9]=[f("全部")])),_:1,__:[9]}),(u(!0),y(D,null,x(N.value,t=>(u(),R(p,{key:t.id,label:t.id,border:""},{default:l(()=>[f(d(t.name),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])])]),_:1})]),_:1}),a(c,{gutter:20,class:"doctor-cards"},{default:l(()=>[(u(!0),y(D,null,x(H.value,t=>(u(),R(g,{key:t.id,span:6},{default:l(()=>[a(G,{class:"doctor-card",shadow:"hover",onClick:E=>I(t)},{default:l(()=>[n("div",fe,[a(L,{size:60,src:t.avatar_url},null,8,["src"]),n("div",ve,[n("h3",null,d(t.name),1),n("p",null,"科室："+d(t.department),1),n("p",null,"职称："+d(z[t.position_rank]||"未知职称"),1)])])]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1}),a(Z,{modelValue:C.value,"onUpdate:modelValue":e[4]||(e[4]=t=>C.value=t),title:"医生详情",width:"600px"},{default:l(()=>[a(X,{modelValue:M.value,"onUpdate:modelValue":e[3]||(e[3]=t=>M.value=t),type:"card"},{default:l(()=>[a(Y,{label:"医生信息",name:"info"},{default:l(()=>[n("div",ge,[a(L,{size:80,src:r.value.avatar_url},null,8,["src"]),n("h3",null,d(r.value.name),1),n("p",null,"科室："+d(r.value.department),1),n("p",null,"职称："+d(z[r.value.position_rank]||"未知职称"),1),n("p",null,"医院："+d(r.value.hospital),1),n("p",null,"擅长："+d(r.value.specialty),1)])]),_:1}),a(Y,{label:"挂号页面",name:"registration"},{default:l(()=>[n("div",ye,[e[12]||(e[12]=n("h4",null,"挂号信息",-1)),a(P,{model:v.value,"label-width":"120px"},{default:l(()=>[a(A,{label:"就诊时间"},{default:l(()=>[n("div",be,[(u(!0),y(D,null,x(U.value,(t,E)=>(u(),R(J,{key:E,type:t.selected?"success":"info",onClick:Ve=>q(t)},{default:l(()=>[f(d(t.date)+" "+d(t.time),1)]),_:2},1032,["type","onClick"]))),128))])]),_:1}),a(A,null,{default:l(()=>[a(_,{type:"primary",onClick:O},{default:l(()=>e[11]||(e[11]=[f("确认挂号")])),_:1,__:[11]})]),_:1})]),_:1},8,["model"])])]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])]))}}},xe=ee(he,[["__scopeId","data-v-8c9f5e02"]]);export{xe as default};
